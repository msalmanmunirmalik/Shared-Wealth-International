import{r as N,j as s,B as D,X as A}from"./index-qPOCZQJE.js";import{P as z}from"./progress-ytO9DXPk.js";import{C as k,c as U}from"./card-DNaL3xTw.js";import{u as F}from"./index-BwmHkgSk.js";import{U as C}from"./upload-ClsNGzYV.js";import{C as L}from"./circle-check-big-nCAMlp3i.js";const h="http://localhost:8080/api";class O{getAuthHeaders(){var t;const n=new Headers,e=localStorage.getItem("session");if(e)try{const l=JSON.parse(e),r=l.access_token||((t=l.session)==null?void 0:t.access_token);r&&n.set("Authorization",`Bearer ${r}`)}catch(l){console.error("Error parsing session from localStorage:",l)}return n}async uploadFile(n,e="general",t,l){const r=new FormData;r.append("file",n),r.append("uploadType",e),t&&r.append("relatedEntityType",t),l&&r.append("relatedEntityId",l);const i=await fetch(`${h}/files/upload`,{method:"POST",headers:this.getAuthHeaders(),body:r});if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.message||`HTTP error! status: ${i.status}`)}return(await i.json()).data}async uploadMultipleFiles(n,e="general",t,l){const r=new FormData;n.forEach(u=>{r.append("files",u)}),r.append("uploadType",e),t&&r.append("relatedEntityType",t),l&&r.append("relatedEntityId",l);const i=await fetch(`${h}/files/upload-multiple`,{method:"POST",headers:this.getAuthHeaders(),body:r});if(!i.ok){const u=await i.json().catch(()=>({}));throw new Error(u.message||`HTTP error! status: ${i.status}`)}return(await i.json()).data}async uploadLogo(n,e){const t=new FormData;t.append("logo",n),e&&t.append("companyId",e);const l=await fetch(`${h}/files/upload-logo`,{method:"POST",headers:this.getAuthHeaders(),body:t});if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.message||`HTTP error! status: ${l.status}`)}return(await l.json()).data}async uploadDocument(n,e){const t=new FormData;t.append("document",n),e&&t.append("documentType",e);const l=await fetch(`${h}/files/upload-document`,{method:"POST",headers:this.getAuthHeaders(),body:t});if(!l.ok){const i=await l.json().catch(()=>({}));throw new Error(i.message||`HTTP error! status: ${l.status}`)}return(await l.json()).data}async uploadImage(n){const e=new FormData;e.append("image",n);const t=await fetch(`${h}/files/upload-image`,{method:"POST",headers:this.getAuthHeaders(),body:e});if(!t.ok){const r=await t.json().catch(()=>({}));throw new Error(r.message||`HTTP error! status: ${t.status}`)}return(await t.json()).data}async getFile(n){const e=await fetch(`${h}/files/${n}`,{method:"GET",headers:this.getAuthHeaders()});if(!e.ok){const l=await e.json().catch(()=>({}));throw new Error(l.message||`HTTP error! status: ${e.status}`)}return(await e.json()).data}async getUserFiles(n){const e=new URL(`${h}/files/user/files`);n&&e.searchParams.append("uploadType",n);const t=await fetch(e.toString(),{method:"GET",headers:this.getAuthHeaders()});if(!t.ok){const r=await t.json().catch(()=>({}));throw new Error(r.message||`HTTP error! status: ${t.status}`)}return(await t.json()).data}async deleteFile(n){const e=await fetch(`${h}/files/${n}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.message||`HTTP error! status: ${e.status}`)}}getFileUrl(n,e="general"){return`${h}/files/serve/${n}?type=${e}`}validateFile(n,e="general"){const t=[],l={general:10485760,logo:2097152,document:10485760,image:5242880};n.size>l[e]&&t.push(`File size must be less than ${Math.round(l[e]/1024/1024)}MB`);const r={general:["image/jpeg","image/png","image/gif","application/pdf"],logo:["image/jpeg","image/png","image/svg+xml"],document:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],image:["image/jpeg","image/png","image/gif","image/webp"]};return r[e].includes(n.type)||t.push(`Invalid file type. Allowed types: ${r[e].join(", ")}`),{isValid:t.length===0,errors:t}}formatFileSize(n){if(n===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(n)/Math.log(e));return parseFloat((n/Math.pow(e,l)).toFixed(2))+" "+t[l]}getFileExtension(n){var e;return((e=n.split(".").pop())==null?void 0:e.toLowerCase())||""}isImageFile(n){return n.type.startsWith("image/")}isDocumentFile(n){return["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(n.type)}}const R=new O,Q=({entityType:P,entityId:n,onUploadComplete:e,maxFiles:t=5,maxSize:l=10,acceptedTypes:r=["image/*","application/pdf","text/*"],className:i=""})=>{const[d,u]=N.useState([]),[v,V]=N.useState([]),[w,E]=N.useState(!1),[S,x]=N.useState(0),[$,j]=N.useState(!1),y=N.useRef(null),I=a=>{const p=Array.from(a),c=[],o=[];p.forEach(m=>{if(m.size>l*1024*1024){o.push(`${m.name} is too large (max ${l}MB)`);return}if(!r.some(g=>g.endsWith("/*")?m.type.startsWith(g.slice(0,-1)):m.type===g)){o.push(`${m.name} has an invalid file type`);return}if(d.length+c.length>=t){o.push(`Maximum ${t} files allowed`);return}c.push(m)}),o.length>0&&o.forEach(m=>F.error(m)),c.length>0&&u(m=>[...m,...c])},b=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?j(!0):a.type==="dragleave"&&j(!1)},T=a=>{a.preventDefault(),a.stopPropagation(),j(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&I(a.dataTransfer.files)},B=a=>{u(p=>p.filter((c,o)=>o!==a))},H=async()=>{if(d.length!==0){E(!0),x(0);try{const a=d.map(async(o,m)=>{const f=new FormData;f.append("file",o),f.append("entityType",P),f.append("entityId",n),f.append("uploadType","document");const g=await R.uploadFile(f);return x((m+1)/d.length*100),g}),c=(await Promise.all(a)).filter(o=>o.success);V(o=>[...o,...c.map(m=>m.data)]),u([]),e==null||e(c.map(o=>o.data)),F.success(`${c.length} file(s) uploaded successfully!`)}catch(a){console.error("Upload failed:",a),F.error("Upload failed. Please try again.")}finally{E(!1),x(0)}}},W=a=>{if(a===0)return"0 Bytes";const p=1024,c=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(a)/Math.log(p));return parseFloat((a/Math.pow(p,o)).toFixed(2))+" "+c[o]},M=a=>a.startsWith("image/")?"ðŸ–¼ï¸":a==="application/pdf"?"ðŸ“„":a.startsWith("text/")?"ðŸ“":"ðŸ“";return s.jsxDEV("div",{className:`space-y-4 ${i}`,children:[s.jsxDEV(k,{className:`border-2 border-dashed transition-colors ${$?"border-blue-500 bg-blue-50":"border-gray-300"}`,onDragEnter:b,onDragLeave:b,onDragOver:b,onDrop:T,children:s.jsxDEV(U,{className:"p-6",children:s.jsxDEV("div",{className:"text-center space-y-4",children:[s.jsxDEV(C,{className:"h-12 w-12 mx-auto text-gray-400"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:181,columnNumber:13},void 0),s.jsxDEV("div",{children:[s.jsxDEV("h3",{className:"text-lg font-semibold",children:"Upload Files"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:183,columnNumber:15},void 0),s.jsxDEV("p",{className:"text-gray-500",children:"Drag and drop files here, or click to select"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:184,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:182,columnNumber:13},void 0),s.jsxDEV(D,{onClick:()=>{var a;return(a=y.current)==null?void 0:a.click()},disabled:w,children:"Choose Files"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:188,columnNumber:13},void 0),s.jsxDEV("input",{ref:y,type:"file",multiple:!0,accept:r.join(","),onChange:a=>a.target.files&&I(a.target.files),className:"hidden"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:194,columnNumber:13},void 0),s.jsxDEV("p",{className:"text-sm text-gray-400",children:["Max ",t," files, ",l,"MB each"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:202,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:180,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:179,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:170,columnNumber:7},void 0),d.length>0&&s.jsxDEV(k,{children:s.jsxDEV(U,{className:"p-4",children:[s.jsxDEV("h4",{className:"font-semibold mb-3",children:["Selected Files (",d.length,")"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:213,columnNumber:13},void 0),s.jsxDEV("div",{className:"space-y-2",children:d.map((a,p)=>s.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsxDEV("div",{className:"flex items-center space-x-2",children:[s.jsxDEV("span",{className:"text-lg",children:M(a.type)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:218,columnNumber:21},void 0),s.jsxDEV("div",{children:[s.jsxDEV("p",{className:"font-medium",children:a.name},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:220,columnNumber:23},void 0),s.jsxDEV("p",{className:"text-sm text-gray-500",children:W(a.size)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:219,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:217,columnNumber:19},void 0),s.jsxDEV(D,{variant:"ghost",size:"sm",onClick:()=>B(p),disabled:w,children:s.jsxDEV(A,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:230,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:224,columnNumber:19},void 0)]},p,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:216,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:214,columnNumber:13},void 0),w&&s.jsxDEV("div",{className:"mt-4 space-y-2",children:[s.jsxDEV("div",{className:"flex justify-between text-sm",children:[s.jsxDEV("span",{children:"Uploading..."},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:239,columnNumber:19},void 0),s.jsxDEV("span",{children:[Math.round(S),"%"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:240,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:238,columnNumber:17},void 0),s.jsxDEV(z,{value:S,className:"w-full"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:237,columnNumber:15},void 0),s.jsxDEV(D,{onClick:H,disabled:w||d.length===0,className:"w-full mt-4",children:w?"Uploading...":`Upload ${d.length} File(s)`},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:246,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:212,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:211,columnNumber:9},void 0),v.length>0&&s.jsxDEV(k,{children:s.jsxDEV(U,{className:"p-4",children:[s.jsxDEV("h4",{className:"font-semibold mb-3",children:["Uploaded Files (",v.length,")"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:261,columnNumber:13},void 0),s.jsxDEV("div",{className:"space-y-2",children:v.map(a=>s.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded",children:[s.jsxDEV("div",{className:"flex items-center space-x-2",children:[s.jsxDEV(L,{className:"h-4 w-4 text-green-500"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:266,columnNumber:21},void 0),s.jsxDEV("div",{children:[s.jsxDEV("p",{className:"font-medium",children:a.originalFilename},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:268,columnNumber:23},void 0),s.jsxDEV("p",{className:"text-sm text-gray-500",children:W(a.fileSize)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:269,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:267,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:265,columnNumber:19},void 0),s.jsxDEV(D,{variant:"ghost",size:"sm",children:s.jsxDEV(ExternalLink,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:273,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:272,columnNumber:19},void 0)]},a.id,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:264,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:262,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:260,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:259,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International/wealth-pioneers-network/src/components/files/FileUpload.tsx",lineNumber:168,columnNumber:5},void 0)};export{Q as F};
