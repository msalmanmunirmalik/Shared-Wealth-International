import{r as N,j as s,B as D,X as M}from"./index-DedRAOeE.js";import{P as z}from"./progress-Db799SF1.js";import{C as U,c as w}from"./card-BfT7EorF.js";import{u as P}from"./index-JHuo1EkI.js";import{U as C}from"./upload-DyoDI8BG.js";import{C as L}from"./circle-check-big-B-XZBkkE.js";const O=()=>"https://sharedwealth.net/api",f=O();class R{getAuthHeaders(){var n;const l=new Headers,e=localStorage.getItem("session");if(e)try{const t=JSON.parse(e),r=t.access_token||((n=t.session)==null?void 0:n.access_token);r&&l.set("Authorization",`Bearer ${r}`)}catch(t){console.error("Error parsing session from localStorage:",t)}return l}async uploadFile(l,e="general",n,t){const r=new FormData;r.append("file",l),r.append("uploadType",e),n&&r.append("relatedEntityType",n),t&&r.append("relatedEntityId",t);const o=await fetch(`${f}/files/upload`,{method:"POST",headers:this.getAuthHeaders(),body:r});if(!o.ok){const p=await o.json().catch(()=>({}));throw new Error(p.message||`HTTP error! status: ${o.status}`)}return(await o.json()).data}async uploadMultipleFiles(l,e="general",n,t){const r=new FormData;l.forEach(p=>{r.append("files",p)}),r.append("uploadType",e),n&&r.append("relatedEntityType",n),t&&r.append("relatedEntityId",t);const o=await fetch(`${f}/files/upload-multiple`,{method:"POST",headers:this.getAuthHeaders(),body:r});if(!o.ok){const p=await o.json().catch(()=>({}));throw new Error(p.message||`HTTP error! status: ${o.status}`)}return(await o.json()).data}async uploadLogo(l,e){const n=new FormData;n.append("logo",l),e&&n.append("companyId",e);const t=await fetch(`${f}/files/upload-logo`,{method:"POST",headers:this.getAuthHeaders(),body:n});if(!t.ok){const o=await t.json().catch(()=>({}));throw new Error(o.message||`HTTP error! status: ${t.status}`)}return(await t.json()).data}async uploadDocument(l,e){const n=new FormData;n.append("document",l),e&&n.append("documentType",e);const t=await fetch(`${f}/files/upload-document`,{method:"POST",headers:this.getAuthHeaders(),body:n});if(!t.ok){const o=await t.json().catch(()=>({}));throw new Error(o.message||`HTTP error! status: ${t.status}`)}return(await t.json()).data}async uploadImage(l){const e=new FormData;e.append("image",l);const n=await fetch(`${f}/files/upload-image`,{method:"POST",headers:this.getAuthHeaders(),body:e});if(!n.ok){const r=await n.json().catch(()=>({}));throw new Error(r.message||`HTTP error! status: ${n.status}`)}return(await n.json()).data}async getFile(l){const e=await fetch(`${f}/files/${l}`,{method:"GET",headers:this.getAuthHeaders()});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.message||`HTTP error! status: ${e.status}`)}return(await e.json()).data}async getUserFiles(l){const e=new URL(`${f}/files/user/files`);l&&e.searchParams.append("uploadType",l);const n=await fetch(e.toString(),{method:"GET",headers:this.getAuthHeaders()});if(!n.ok){const r=await n.json().catch(()=>({}));throw new Error(r.message||`HTTP error! status: ${n.status}`)}return(await n.json()).data}async deleteFile(l){const e=await fetch(`${f}/files/${l}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!e.ok){const n=await e.json().catch(()=>({}));throw new Error(n.message||`HTTP error! status: ${e.status}`)}}getFileUrl(l,e="general"){return`${f}/files/serve/${l}?type=${e}`}validateFile(l,e="general"){const n=[],t={general:10485760,logo:2097152,document:10485760,image:5242880};l.size>t[e]&&n.push(`File size must be less than ${Math.round(t[e]/1024/1024)}MB`);const r={general:["image/jpeg","image/png","image/gif","application/pdf"],logo:["image/jpeg","image/png","image/svg+xml"],document:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],image:["image/jpeg","image/png","image/gif","image/webp"]};return r[e].includes(l.type)||n.push(`Invalid file type. Allowed types: ${r[e].join(", ")}`),{isValid:n.length===0,errors:n}}formatFileSize(l){if(l===0)return"0 Bytes";const e=1024,n=["Bytes","KB","MB","GB"],t=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,t)).toFixed(2))+" "+n[t]}getFileExtension(l){var e;return((e=l.split(".").pop())==null?void 0:e.toLowerCase())||""}isImageFile(l){return l.type.startsWith("image/")}isDocumentFile(l){return["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(l.type)}}const _=new R,Y=({entityType:E,entityId:l,onUploadComplete:e,maxFiles:n=5,maxSize:t=10,acceptedTypes:r=["image/*","application/pdf","text/*"],className:o=""})=>{const[d,p]=N.useState([]),[v,V]=N.useState([]),[g,k]=N.useState(!1),[S,x]=N.useState(0),[$,j]=N.useState(!1),y=N.useRef(null),I=a=>{const u=Array.from(a),c=[],i=[];u.forEach(m=>{if(m.size>t*1024*1024){i.push(`${m.name} is too large (max ${t}MB)`);return}if(!r.some(F=>F.endsWith("/*")?m.type.startsWith(F.slice(0,-1)):m.type===F)){i.push(`${m.name} has an invalid file type`);return}if(d.length+c.length>=n){i.push(`Maximum ${n} files allowed`);return}c.push(m)}),i.length>0&&i.forEach(m=>P.error(m)),c.length>0&&p(m=>[...m,...c])},b=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?j(!0):a.type==="dragleave"&&j(!1)},T=a=>{a.preventDefault(),a.stopPropagation(),j(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&I(a.dataTransfer.files)},B=a=>{p(u=>u.filter((c,i)=>i!==a))},A=async()=>{if(d.length!==0){k(!0),x(0);try{const a=d.map(async(i,m)=>{const h=new FormData;h.append("file",i),h.append("entityType",E),h.append("entityId",l),h.append("uploadType","document");const F=await _.uploadFile(h);return x((m+1)/d.length*100),F}),c=(await Promise.all(a)).filter(i=>i.success);V(i=>[...i,...c.map(m=>m.data)]),p([]),e==null||e(c.map(i=>i.data)),P.success(`${c.length} file(s) uploaded successfully!`)}catch(a){console.error("Upload failed:",a),P.error("Upload failed. Please try again.")}finally{k(!1),x(0)}}},W=a=>{if(a===0)return"0 Bytes";const u=1024,c=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(a)/Math.log(u));return parseFloat((a/Math.pow(u,i)).toFixed(2))+" "+c[i]},H=a=>a.startsWith("image/")?"ðŸ–¼ï¸":a==="application/pdf"?"ðŸ“„":a.startsWith("text/")?"ðŸ“":"ðŸ“";return s.jsxDEV("div",{className:`space-y-4 ${o}`,children:[s.jsxDEV(U,{className:`border-2 border-dashed transition-colors ${$?"border-blue-500 bg-blue-50":"border-gray-300"}`,onDragEnter:b,onDragLeave:b,onDragOver:b,onDrop:T,children:s.jsxDEV(w,{className:"p-6",children:s.jsxDEV("div",{className:"text-center space-y-4",children:[s.jsxDEV(C,{className:"h-12 w-12 mx-auto text-gray-400"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:181,columnNumber:13},void 0),s.jsxDEV("div",{children:[s.jsxDEV("h3",{className:"text-lg font-semibold",children:"Upload Files"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:183,columnNumber:15},void 0),s.jsxDEV("p",{className:"text-gray-500",children:"Drag and drop files here, or click to select"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:184,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:182,columnNumber:13},void 0),s.jsxDEV(D,{onClick:()=>{var a;return(a=y.current)==null?void 0:a.click()},disabled:g,children:"Choose Files"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:188,columnNumber:13},void 0),s.jsxDEV("input",{ref:y,type:"file",multiple:!0,accept:r.join(","),onChange:a=>a.target.files&&I(a.target.files),className:"hidden"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:194,columnNumber:13},void 0),s.jsxDEV("p",{className:"text-sm text-gray-400",children:["Max ",n," files, ",t,"MB each"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:202,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:180,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:179,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:170,columnNumber:7},void 0),d.length>0&&s.jsxDEV(U,{children:s.jsxDEV(w,{className:"p-4",children:[s.jsxDEV("h4",{className:"font-semibold mb-3",children:["Selected Files (",d.length,")"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:213,columnNumber:13},void 0),s.jsxDEV("div",{className:"space-y-2",children:d.map((a,u)=>s.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsxDEV("div",{className:"flex items-center space-x-2",children:[s.jsxDEV("span",{className:"text-lg",children:H(a.type)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:218,columnNumber:21},void 0),s.jsxDEV("div",{children:[s.jsxDEV("p",{className:"font-medium",children:a.name},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:220,columnNumber:23},void 0),s.jsxDEV("p",{className:"text-sm text-gray-500",children:W(a.size)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:221,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:219,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:217,columnNumber:19},void 0),s.jsxDEV(D,{variant:"ghost",size:"sm",onClick:()=>B(u),disabled:g,children:s.jsxDEV(M,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:230,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:224,columnNumber:19},void 0)]},u,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:216,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:214,columnNumber:13},void 0),g&&s.jsxDEV("div",{className:"mt-4 space-y-2",children:[s.jsxDEV("div",{className:"flex justify-between text-sm",children:[s.jsxDEV("span",{children:"Uploading..."},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:239,columnNumber:19},void 0),s.jsxDEV("span",{children:[Math.round(S),"%"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:240,columnNumber:19},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:238,columnNumber:17},void 0),s.jsxDEV(z,{value:S,className:"w-full"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:242,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:237,columnNumber:15},void 0),s.jsxDEV(D,{onClick:A,disabled:g||d.length===0,className:"w-full mt-4",children:g?"Uploading...":`Upload ${d.length} File(s)`},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:246,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:212,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:211,columnNumber:9},void 0),v.length>0&&s.jsxDEV(U,{children:s.jsxDEV(w,{className:"p-4",children:[s.jsxDEV("h4",{className:"font-semibold mb-3",children:["Uploaded Files (",v.length,")"]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:261,columnNumber:13},void 0),s.jsxDEV("div",{className:"space-y-2",children:v.map(a=>s.jsxDEV("div",{className:"flex items-center justify-between p-2 bg-green-50 rounded",children:[s.jsxDEV("div",{className:"flex items-center space-x-2",children:[s.jsxDEV(L,{className:"h-4 w-4 text-green-500"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:266,columnNumber:21},void 0),s.jsxDEV("div",{children:[s.jsxDEV("p",{className:"font-medium",children:a.originalFilename},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:268,columnNumber:23},void 0),s.jsxDEV("p",{className:"text-sm text-gray-500",children:W(a.fileSize)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:269,columnNumber:23},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:267,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:265,columnNumber:19},void 0),s.jsxDEV(D,{variant:"ghost",size:"sm",children:s.jsxDEV(ExternalLink,{className:"h-4 w-4"},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:273,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:272,columnNumber:19},void 0)]},a.id,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:264,columnNumber:17},void 0))},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:262,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:260,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:259,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/m.salmanmalik/Development Projects/Shared Wealth International Final/src/components/files/FileUpload.tsx",lineNumber:168,columnNumber:5},void 0)};export{Y as F};
